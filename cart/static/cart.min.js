CartModal=function(t){function a(){$.get(t,r)}function r(t){var a=$(t);a.modal(),a.on("hidden.bs.modal",function(){a.remove()})}$("body").on("click","[data-role=open-cart-btn]",a),this.show=a},Cart=function(t){var a=$("body"),r=new CartModal(t.urls.modal);function o(t){$("[data-role=cart-total]").text(t.total),$.notify({message:t.message},{type:"success"})}function e(t,a){$("[data-role=add-to-cart]").filter("[data-product-id="+t+"]").prop("disabled",!a)}function n(t){$.notify({message:t.responseJSON.message},{type:"danger"})}a.on("click","[data-role=add-to-cart]",function(){var a=$(this).data("product-id");e(a,!1),$.post(t.urls.add,{csrfmiddlewaretoken:t.csrf,product:a},function(t){o(t),r.show()}).fail(n)}),a.on("click","[data-role=remove-from-cart]",function(){var a=$(this).data("product-id");$(this).closest("[data-role=cart-item]").remove(),e(a,!0),$.post(t.urls.remove,{csrfmiddlewaretoken:t.csrf,product:a},o)}),a.on("input","[data-role=cart-item-qty]",function(){var a=$(this).data("product-id"),r=$(this).prop("max"),e=parseInt($(this).val());return e<1&&(e=1,$(this).val(e)),r&&e>r&&(e=r,$(this).val(e)),$.post(t.urls.setQty,{csrfmiddlewaretoken:t.csrf,product:a,qty:e},function(t){o(t),function(t,a){$("[data-role=cart-item-total]").filter("[data-product-id="+t+"]").text(a)}(a,t.result.total)})}),a.on("click","[data-role=plus-cart-item-qty]",function(){var t=$(this).parent().find("input");t.val(parseInt(t.val())+1).trigger("input")}),a.on("click","[data-role=minus-cart-item-qty]",function(){var t=$(this).parent().find("input");t.val(parseInt(t.val())-1).trigger("input")})};